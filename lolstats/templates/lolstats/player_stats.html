{% extends 'lolstats/layout.html' %}
{% load ttags %}

{% block title %}
Player stats
{% endblock %}

{% block content %}
<div class="container-xxl py-4 overflow-auto">
    <div class="p-3 rounded-3 overflow-hidden">
        <div class="container-fluid">
            <p class="h1">{{summoner_info.name}} <span class="badge rounded-pill bg-secondary"
                    style="font-size:1rem;">Lvl {{summoner_info.summonerLevel}}</span></p>
            <div class="row mb-auto text-left align-items-center">
                <div class="col-md-2" style="max-height: 120px; max-width: 120px;">
                    <div class="rounded-5 border border-3 w-auto h-auto overflow-hidden">
                        <img src="http://ddragon.leagueoflegends.com/cdn/13.3.1/img/profileicon/{{summoner_info.profileIconId}}.png"
                            alt="summoner icon" class="img-fluid">
                    </div>
                </div>
                <div class="col-md-10">
                    <div class="row">
                        <div class="col-md-auto">
                            {% if not account_stats %}
                            <p class="h6">UNRANKED</p>
                            {% else %}
                            {% for queue in account_stats %}
                            {% if queue.tier == 'CHALLENGER' or queue.tier == 'MASTER' or queue.tier == 'GRANDMASTER' %}
                            <p class="h6"><span class="tier">{{queue.tier}}</span><span class="rank"></span>
                                {{queue.leaguePoints}}LP</p>
                            {% else %}
                            <p class="h6"><span class="tier">{{queue.tier}}</span><span class="rank">
                                    {{queue.rank}}</span> {{queue.leaguePoints}}LP</p>
                            {% endif %}
                            {% endfor %}
                            {% endif %}
                        </div>
                        <div class="col-md-auto">
                            {% if not account_stats %}
                            <p class="h6">RANKED_SOLO_5x5</p>
                            {% else %}
                            {% for queue in account_stats %}
                            <p class="h6">{{queue.queueType}}</p>
                            {% endfor %}
                            {% endif %}
                        </div>
                        <div class="col-md-auto">
                            {% if not account_stats %}
                            <p class="h6">W/L 0-0 WINRATE 0%</p>
                            {% else %}
                            {% for queue in account_stats %}
                            <p class="h6">W/L <span class="win">{{queue.wins}}</span>-<span
                                    class="loss">{{queue.losses}}</span> WINRATE <span
                                    class="winrate">{{queue.winrate|floatformat:1}}%</span></p>
                            {% endfor %}
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <nav class="nav">
        <a class="nav-link active text-light-emphasis" aria-current="page" href="{{ request.path }}">Overview</a>
        <a class="nav-link text-muted" href="{{ request.path }}live/">Live Game</a>
    </nav>
    <div class="row align-items-md-stretch">
        <div class="col-md-4 text-center">
            <div class="p-1 rounded-3" style="background-color: #2c2f33;">
                <div class="m-1 p-2 border border-secondary-subtle rounded-3">
                    <h6>{% include './icons/layers.svg' %} CHAMPIONS {% include './icons/layers.svg' %}</h6>
                    <hr>
                    <div class="overflow-auto">
                        <table class="table table-sm table-hover table-dark table-striped w-100">
                            <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    {% for col in champ_df.columns %}
                                    <th scope="col">{{ col|upper }}</th>
                                    {% endfor %}
                                </tr>
                            </thead>
                            <tbody>
                                {% for row in champ_df.values %}
                                <tr>
                                    <th scope="col">{{forloop.counter}}</th>
                                    {% for value in row %}
                                    <td>{{ value }}</td>
                                    {% endfor %}
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="m-1 p-2 border border-secondary-subtle rounded-3">
                    <h6>{% include './icons/bar-chart.svg' %} STATS {% include './icons/bar-chart.svg' %}</h6>
                    <hr>
                    <div class="overflow-auto">
                        <table class="table table-sm table-hover table-dark table-striped w-100">
                            <thead>
                                <tr>
                                    <th scope="col">STAT</th>
                                    {% for col in player_stats_df.columns %}
                                    <th scope="col">{{ col|upper }}</th>
                                    {% endfor %}
                                </tr>
                            </thead>
                            <tbody>
                                {% for row, stat in player_stats_df.values|zip:player_stats_df.index %}
                                <tr>
                                    <td>{{ stat|upper }}</td>
                                    {% for value in row %}
                                    {% if value != value %}
                                    <td> </td>
                                    {% else %}
                                    <td>{{ value }}</td>
                                    {% endif %}
                                    {% endfor %}
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="m-1 p-2 border border-secondary-subtle rounded-3">
                    <h6>{% include './icons/text-left.svg' %} QUEUES {% include './icons/text-left.svg' %}</h6>
                    <hr>
                    <div class="overflow-auto">
                        <table class="table table-sm table-hover table-dark table-striped w-100">
                            <thead>
                                <tr>
                                    {% for col in queue_df.columns %}
                                    <th scope="col">{{ col|upper }}</th>
                                    {% endfor %}
                                </tr>
                            </thead>
                            <tbody>
                                {% for row in queue_df.values %}
                                <tr>
                                    {% for value in row %}
                                    {% if forloop.counter == 1 %}
                                    <td class="queue">{{ value }}</td>
                                    {% else %}
                                    <td>{{ value }}</td>
                                    {% endif %}
                                    {% endfor %}
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                <div>
                    <p class="h4"><span class="winrate">{{ global_winrate.winrate }}</span> | <span
                            class="win">{{global_winrate.win}}</span> - <span
                            class="loss">{{global_winrate.loss}}</span></p>
                    <p class="h6">Global Record</p>
                    <p>Stats based on <span class="h6">{{ global_winrate.number_of_games }}</span> games</p>
                </div>
            </div>
        </div>
        <div class="col-md-8">
            {% for match, player in match_history|zip:player_history %}
            <div class="h5 text-left">{{player.championName}} - <span class="queue">{{match.info.queueId}}</span></div>
            <div class="p-3 rounded-3 mb-1" style="background-color: #2c2f33;">
                <div class="row align-items-center flex-nowrap overflow-auto">
                    <div class="col-auto">
                        <div class="row align-items-center">
                            <div class="col-auto gx-2">
                                <div class="row justify-content-center">
                                    {% if player.teamPosition %}
                                    <div class="rounded-3 w-auto h-auto overflow-hidden">
                                        <img src="https://raw.communitydragon.org/latest/plugins/rcp-fe-lol-clash/global/default/assets/images/position-selector/positions/icon-position-{{player.teamPosition|lower}}-disabled.png"
                                            alt="role icon" class="img-fluid" width="50" height="50">
                                    </div>
                                    {% endif %}
                                </div>
                                <div class="row justify-content-center mx-1 h6">Lvl {{player.champLevel}}</div>
                            </div>
                            <div class="col-auto gx-2">
                                <div class="rounded-4 overflow-hidden">
                                    <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/v1/champion-icons/{{player.championId}}.png"
                                        alt="role icon" class="img-fluid" width="70px" height="70px">
                                </div>
                            </div>
                            <div class="col-auto gx-2">
                                <div class="row justify-content-center">
                                    <div class="col-auto">
                                        <div class="rounded-2 mb-1 overflow-hidden">
                                            {% if player.summoner1 %}
                                            <img src="http://ddragon.leagueoflegends.com/cdn/13.4.1/img/spell/{{player.summoner1}}.png"
                                                alt="summoner icon" class="img-fluid" width="30px" height="30px">
                                            {% else %}
                                            <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/data/spells/icons2d/summoner_empty.png"
                                                alt="item icon" class="img-fluid" width="30px" height="30px">
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="col-auto">
                                        <div class="rounded-2 overflow-hidden">
                                            {% if player.summoner2 %}
                                            <img src="http://ddragon.leagueoflegends.com/cdn/13.4.1/img/spell/{{player.summoner2}}.png"
                                                alt="summoner icon" class="img-fluid" width="30px" height="30px">
                                            {% else %}
                                            <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/data/spells/icons2d/summoner_empty.png"
                                                alt="item icon" class="img-fluid" width="30px" height="30px">
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto gx-2">
                                <div class="row justify-content-center">
                                    <div class="col-auto">
                                        <div class="rounded-2 mb-1 overflow-hidden">
                                            <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/v1/perk-images/styles/{{player.keystone}}"
                                                alt="summoner icon" class="img-fluid" width="35px" height="35px">
                                        </div>
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="col-auto">
                                        <div class="rounded-2 mb-1 overflow-hidden">
                                            <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/v1/perk-images/styles/{{player.substyle}}"
                                                alt="summoner icon" class="img-fluid" width="20px" height="20px">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto mx-1">
                                <div class="row justify-content-center h5">
                                    {{player.kills}}/{{player.deaths}}/{{player.assists}}</div>
                                <div class="row justify-content-center h6">{{player.challenges.kda|floatformat}} KDA
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-auto mx-2">
                        <div class="row align-items-center">
                            <div class="col-auto">
                                <div class="row justify-content-center">
                                    <div class="col-auto gx-1">
                                        <div class="rounded-2 mb-1 overflow-hidden">
                                            {% if player.item0 != 0 %}
                                            <img src="http://ddragon.leagueoflegends.com/cdn/13.4.1/img/item/{{player.item0}}.png"
                                                alt="item icon" class="img-fluid" width="30px" height="30px">
                                            {% else %}
                                            <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/assets/items/icons2d/gp_ui_placeholder.png"
                                                alt="item icon" class="img-fluid" width="30px" height="30px">
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="col-auto gx-1">
                                        <div class="rounded-2 overflow-hidden">
                                            {% if player.item3 != 0 %}
                                            <img src="http://ddragon.leagueoflegends.com/cdn/13.4.1/img/item/{{player.item3}}.png"
                                                alt="item icon" class="img-fluid" width="30px" height="30px">
                                            {% else %}
                                            <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/assets/items/icons2d/gp_ui_placeholder.png"
                                                alt="item icon" class="img-fluid" width="30px" height="30px">
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto">
                                <div class="row justify-content-center">
                                    <div class="col-auto gx-1">
                                        <div class="rounded-2 mb-1 overflow-hidden">
                                            {% if player.item1 != 0 %}
                                            <img src="http://ddragon.leagueoflegends.com/cdn/13.4.1/img/item/{{player.item1}}.png"
                                                alt="item icon" class="img-fluid" width="30px" height="30px">
                                            {% else %}
                                            <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/assets/items/icons2d/gp_ui_placeholder.png"
                                                alt="item icon" class="img-fluid" width="30px" height="30px">
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="col-auto gx-1">
                                        <div class="rounded-2 overflow-hidden">
                                            {% if player.item4 != 0 %}
                                            <img src="http://ddragon.leagueoflegends.com/cdn/13.4.1/img/item/{{player.item4}}.png"
                                                alt="item icon" class="img-fluid" width="30px" height="30px">
                                            {% else %}
                                            <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/assets/items/icons2d/gp_ui_placeholder.png"
                                                alt="item icon" class="img-fluid" width="30px" height="30px">
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto">
                                <div class="row justify-content-center">
                                    <div class="col-auto mb-1 gx-1">
                                        <div class="rounded-2 overflow-hidden">
                                            {% if player.item2 != 0 %}
                                            <img src="http://ddragon.leagueoflegends.com/cdn/13.4.1/img/item/{{player.item2}}.png"
                                                alt="item icon" class="img-fluid" width="30px" height="30px">
                                            {% else %}
                                            <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/assets/items/icons2d/gp_ui_placeholder.png"
                                                alt="item icon" class="img-fluid" width="30px" height="30px">
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="col-auto gx-1">
                                        <div class="rounded-2 overflow-hidden">
                                            {% if player.item5 != 0 %}
                                            <img src="http://ddragon.leagueoflegends.com/cdn/13.4.1/img/item/{{player.item5}}.png"
                                                alt="item icon" class="img-fluid" width="30px" height="30px">
                                            {% else %}
                                            <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/assets/items/icons2d/gp_ui_placeholder.png"
                                                alt="item icon" class="img-fluid" width="30px" height="30px">
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto mx-1">
                                <div class="row justify-content-center">
                                    <div class="col-auto h7" style="color:#81e6d9;">
                                        CS: {{player.totalMinionsKilled}}
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="col-auto h7" style="color:#f3a05a;">
                                        GOLD: {{player.goldEarned|div:1000|floatformat}}k
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="col-auto h7" style="color:#e25656;">
                                        DMG: {{player.totalDamageDealtToChampions|div:1000|floatformat}}k
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="col-auto h7" style="color:#b78787;">
                                        KP:
                                        {{player.kills|add:player.assists|percent:match.info.teams.0.objectives.champion.kills|floatformat}}%
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-auto">
                        <div class="row align-items-center">
                            <div class="col-auto">
                                <div class="row justify-content-right">p1</div>
                                <div class="row justify-content-right">p2</div>
                                <div class="row justify-content-right">p3</div>
                                <div class="row justify-content-right">p4</div>
                                <div class="row justify-content-right">p5</div>
                            </div>
                            <div class="col-auto gx-1">
                                <div class="row justify-content-center">
                                    <div class="overflow-hidden">
                                        <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/v1/champion-icons/{{match.info.participants.0.championId}}.png"
                                            alt="role icon" class="img-fluid" width="20px" height="20px">
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="overflow-hidden">
                                        <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/v1/champion-icons/{{match.info.participants.1.championId}}.png"
                                            alt="role icon" class="img-fluid" width="20px" height="20px">
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="overflow-hidden">
                                        <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/v1/champion-icons/{{match.info.participants.2.championId}}.png"
                                            alt="role icon" class="img-fluid" width="20px" height="20px">
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="overflow-hidden">
                                        <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/v1/champion-icons/{{match.info.participants.3.championId}}.png"
                                            alt="role icon" class="img-fluid" width="20px" height="20px">
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="overflow-hidden">
                                        <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/v1/champion-icons/{{match.info.participants.4.championId}}.png"
                                            alt="role icon" class="img-fluid" width="20px" height="20px">
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto gx-1">
                                <div class="row justify-content-center">
                                    <div class="rounded-3 w-auto h-auto overflow-hidden">
                                        <img src="https://raw.communitydragon.org/latest/plugins/rcp-fe-lol-clash/global/default/assets/images/position-selector/positions/icon-position-top-blue-hover.png"
                                            alt="role icon" class="img-fluid" width="20" height="20">
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="rounded-3 w-auto h-auto overflow-hidden">
                                        <img src="https://raw.communitydragon.org/latest/plugins/rcp-fe-lol-clash/global/default/assets/images/position-selector/positions/icon-position-jungle-blue-hover.png"
                                            alt="role icon" class="img-fluid" width="20" height="20">
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="rounded-3 w-auto h-auto overflow-hidden">
                                        <img src="https://raw.communitydragon.org/latest/plugins/rcp-fe-lol-clash/global/default/assets/images/position-selector/positions/icon-position-middle-blue-hover.png"
                                            alt="role icon" class="img-fluid" width="20" height="20">
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="rounded-3 w-auto h-auto overflow-hidden">
                                        <img src="https://raw.communitydragon.org/latest/plugins/rcp-fe-lol-clash/global/default/assets/images/position-selector/positions/icon-position-bottom-blue-hover.png"
                                            alt="role icon" class="img-fluid" width="20" height="20">
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="rounded-3 w-auto h-auto overflow-hidden">
                                        <img src="https://raw.communitydragon.org/latest/plugins/rcp-fe-lol-clash/global/default/assets/images/position-selector/positions/icon-position-utility-blue-hover.png"
                                            alt="role icon" class="img-fluid" width="20" height="20">
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto gx-1">
                                <div class="row justify-content-center">
                                    <div class="overflow-hidden">
                                        <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/v1/champion-icons/{{match.info.participants.5.championId}}.png"
                                            alt="role icon" class="img-fluid" width="20px" height="20px">
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="overflow-hidden">
                                        <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/v1/champion-icons/{{match.info.participants.6.championId}}.png"
                                            alt="role icon" class="img-fluid" width="20px" height="20px">
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="overflow-hidden">
                                        <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/v1/champion-icons/{{match.info.participants.7.championId}}.png"
                                            alt="role icon" class="img-fluid" width="20px" height="20px">
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="overflow-hidden">
                                        <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/v1/champion-icons/{{match.info.participants.8.championId}}.png"
                                            alt="role icon" class="img-fluid" width="20px" height="20px">
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div class="overflow-hidden">
                                        <img src="https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/v1/champion-icons/{{match.info.participants.9.championId}}.png"
                                            alt="role icon" class="img-fluid" width="20px" height="20px">
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto">
                                <div class="row justify-content-left">p6</div>
                                <div class="row justify-content-left">p7</div>
                                <div class="row justify-content-left">p8</div>
                                <div class="row justify-content-left">p9</div>
                                <div class="row justify-content-left">p10</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-auto mx-1">
                        <div class="row justify-content-center">{% include './icons/stopwatch-fill.svg' %}</div>
                        <div class="row justify-content-center h6">{{match.info.gameDuration|time}}</div>
                        <div class="row justify-content-center h7">{{match.info.gameCreation}}</div>
                    </div>
                </div>
            </div>
            {% endfor %}
            <form class="text-center" method="get" action="{{ request.path }}">
                <input type="hidden" name="load_more" id="load_more" value="{{ match_history|length }}">
                <button type="submit" class="btn btn-outline-light mt-2">
                    Load More
                </button>
            </form>
        </div>
    </div>
    {{ queue_ids|json_script:"queue_ids" }}
    <p id="test"></p>
    <script src="\static\js\account_colours.js"></script>
    <script src="\static\js\queue_ids.js"></script>
    {% endblock %}